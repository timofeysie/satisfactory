# April 2022

## goto detail broken again

How does this keep happening?

```err
getProducts calling  <http://localhost:3333/api/products/undefined.json>
zone.js:2863          GET <http://localhost:3333/api/products/undefined.json> net::ERR_CONNECTION_REFUSED
...
onProductSelected @ product-list.component.ts:100
onHandleSelectedArticle @ product-list.component.ts:114
ProductListComponent_mat_card_8_Template_demo_app_article_list_handleSelectedArticle_11_listener @ product-list.component.html:51
...
onSelectedArticle @ article-list.component.ts:14
ArticleListComponent_div_1_span_1_Template_a_click_1_listener @ article-list.component.html:28
...
core.js:6456 ERROR HttpErrorResponse {headers: HttpHeaders, status: 0, statusText: 'Unknown Error', url: 'http://localhost:3333/api/products/undefined.json', ok: false, …}
```

Didn't we fix this already?

We did, however, it appears that when the backend encounters this error, it is unable to recover and needs to be restarted.  If the list is refreshed, it fails to load anything into the front end until it's reset.

This is the output on the backend:

```err
Successfully wrote file
default undefined.json
product.service: getCategory undefined.json
resolving undefined

C:\Users\timof\repos\satisfactory\dist\apps\nest-demo\webpack:\apps\nest-demo\src\app\products\products.service.ts:47
        resolve(JSON.parse(file));
                     ^
SyntaxError: Unexpected token u in JSON at position 0
    at JSON.parse (<anonymous>)
    at ReadFileContext.callback (C:\Users\timof\repos\satisfactory\dist\apps\nest-demo\webpack:\apps\nest-demo\src\app\products\products.service.ts:47:22)
    at FSReqCallback.readFileAfterOpen [as oncomplete] (fs.js:282:13)
```

Catching the error there if the file is undefined and returning the error, then restart the server.

Choosing load list shows this frontend console error:

```err
core.js:6456 ERROR Error: NG0100: ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '27.524066666666666 minutes ago'. Current value: '27.524233333333335 minutes ago'.. Find more at https://angular.io/errors/NG0100
    at throwErrorIfNoChangesMode (core.js:6753:1)
```

Same for generate list apparently.  But it appears to work.

The NRL is investigating a physical altercation between Brisbane Broncos players Payne Haas and Albert Kelly that appeared to occur over the weekend. Haas can be heard in the footage calling Kelly a 'f****** c***', while Kelly repeatedly claims he didn't step on Haas' shoes. Haas was fined $50,000 and banned for verbally assaulting police last year. Kelly is expected to be sidelined for around 3-4 months with a foot injury.

The police have also launched an investigation into a fight.  They say the incident could have been more serious if the players were caught on camera using their mobile phones.

The Broncos have lost two of their first two games in the NRL season. They are expected to face a further suspension from the NRL after the incident.

## Mashup type improvements

The 'two' imageUrl is set if the mashup steps are followed, but the "tags": "", and "source": "" are not set.

Man City vs Atlético Madrid

On the detail page, content is shown for both one and two.  If type is mashup, then we don't want descriptions and meta-descriptions for both.

After doing another mashup for Pakistan vs Australia, the source for one is not being set properly either:

```json
"source": "https://commons.wikimedia.org/wiki/File:",
```

## Title 30 characters needs character count

meta-description: Kevin De Bruyne gives Manchester City advantage against Atlético Madrid |  Champions League | The Guardian

Image details:

C:/Users/timof/repos/timofeysie/satisfactory/apps/toonify/src/cartooned_img/Dubai_Sports_City_Pak_vs_Aussies_Shinkai.jpg

22 hours ago
Kevin De Bruyne gives Manchester City ...
theguardian.com

Man City vs Atletico Madrid highlights and reaction as Kevin De Bruyne  scores from stunning Foden pass - Manchester Evening News
22 hours ago
Man City vs Atletico Madrid highlights ...
manchestereveningnews.co.uk

We want the title to indicate it's about the image, not the event.

AI generated image for XXX format?  It needs to be brief:

AI image for Man City vs Atlético Madrid ...

AI generated image for Man City vs Atlé ...

That's why we need a counter on that field.

And we want to automatically be adding this blurb.  Possibly from a drop down list.

## Kickoff image generation doesn't

The output:

```txt
gan.service.kickOffGan: start all
gan.service.startProcess: resolved CPU mode
Done!
gan.service.startProcess: resolved CPU mode
Done!
gan.service.startProcess: resolved CPU mode
Done!
gan.service.startProcess: resolved CPU mode
Done!
```

The manual command if needed:

python test.py --input_dir YourImgDir --style Paprika --gpu 0

C:\Users\timof\repos\satisfactory\apps\toonify\src\test_img

python apps\toonify\src\test_image_cyclegan.py --file apps\toonify\src\test_img\Paddy_Pimblett_ufc.jpg

Possibly this is an error due to uppercase JPG file ext?

AI image for Man City vs Atlético Madrid.JPG

Yes, that was it.  Here is the kickoff output with the lower case extension:

```txt
gan.service.kickOffGan: start all
(node:20360) UnhandledPromiseRejectionWarning: [object Uint8Array]     
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20360) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use 
the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 1)
(node:20360) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.
(node:20360) UnhandledPromiseRejectionWarning: [object Uint8Array]
(node:20360) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use 
the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 2)
(node:20360) UnhandledPromiseRejectionWarning: [object Uint8Array]
(node:20360) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use 
the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 3)
(node:20360) UnhandledPromiseRejectionWarning: [object Uint8Array]
(node:20360) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use 
the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 4)
gan.service.startProcess: resolved CPU mode
Done!
gan.service.startProcess: resolved CPU mode
Done!
gan.service.startProcess: resolved CPU mode
Done!
Done!
gan.service.startProcess: resolved CPU mode
```

Someone needs to tell Gimp to save it's images with a lower case file extension!

Or, we could account for the uppercase value...

## NST again

python apps\toonify\src\NST_train_single_image.py --input_dir apps\toonify\src\cartooned_img\Dubai_Sports_City_Pak_vs_Aussies_Shinkai.jpg --style_image apps\toonify\src\style_img\Zicht_op_Parijs_vanuit_Vincents_kamer_in_de_rue_Lepic.jpg --output_file Dubai_Sports_City_Pak_vs_Aussies_Shinkai-using-Zicht_op_Parijs_vanuit_Vincents_kamer_in_de_rue_Lepic.jpg

## Todo

- snackbar for save list function
