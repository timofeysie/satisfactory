# May

## Add json file name to the exported articles json

How does that filename get generated?

Where are the functions that do it?

generateList() { }

  saveFile(articles: any) {
    const jsonString = JSON.stringify(articles);
    fs.writeFile('./articles/articles.json', jsonString, (err) => { ... }

The written file is here:

articles\articles.json

Is it OK to use that file directly from different projects on this laptop?  Previously I copy it over to Tundra, but now that the AMP frontend is being worked on, it needs to be copied there as well.

## Summaries

Error: ENOENT: no such file or directory, open 'C:\Users\timof\repos\satisfactory\apps\nest-demo\src\app\bart\summaries\https%3A%2F%2Fwww.sportingnews.com%2Fau%2Fsoccer%2Fnews%2Fchelsea-vs-liverpool-score-live-fa-cup-final%2Fiurgrbkbcgva0algwhqhpyeo.txt'

This is becoming a pain in the ass.  My first suspicion is that the target article is too long for goose.  How do we test that out?  Does this take precendence over the important story creation?

It's worth looking into.  Not sure which has priority.

## Create a story from the dog-demo template upon article post

This is where the post gets written.

apps\nest-demo\src\app\trends\trends.service.ts

Since this is not the ideal way to generate stories from json files, it's best to not spend too much time on it.

Still, we don't want to just have a long html string literal there to plug in our variables to.

However, creating a lib to be used by a service didn't seem to work when we were trying to collect bing search results to put together for content to train our NPL model to create content with.

I think it's worth using a provider.

### NestJS providers

<https://docs.nestjs.com/providers>

A service is an injected provider used by the controller.  Maybe then we just need a new service to handle this exclusively.

apps\nest-demo\src\app\trends\trends.controller.ts

apps\nest-demo\src\app\trends\story.service.ts

Something about this seems a bit funny:

```ts
  @Post()
  create(@Body() createTrendDto: any) {
    this.storyService.create(createTrendDto);
    return this.trendsService.create(createTrendDto);
  }
```

We don't really use the result from either of these yet, so I suppose it's all right.  The user can optimistically look for the generated results elsewhere in the app.  Since some of the async tasks are long running sometimes its not possible to keep the connection open.

Or maybe it is.  Maybe we want to do something like Promises.all here and send aggrigated results back.  But for now, let's just focus on the functionality of generating a story from a template.

Renaming:
posts\-UFC-lightweight-champion-Charles-Oliveira-on-a-career-low.json

To:
posts\UFC-lightweight-champion-Charles-Oliveira-on-a-career-low.json

When trying to test the story.service, this laptop crashed.  There were two images donwloaded, and the usual summaries scraped and barted.  No summaries were created, so defo the barting needs to be looked at.

I think we gotta stop the automatic ml work.  Let the user kick off each step as they go.  Some images will not need to be used to generate other styled images.  An article with images from the public domain might be wanted to support the info in the stories.

So the only automatic generation happens when the user goes from the first post form to the final page.  The images selected in the previous stage are downloaded and then generation starts, at the same time the selected articles from the first step are downloaded and summarized.  This is causing the laptop to crash sometimes.  Not good.

I think the best thing to do is either not to have any images in the test-images directory, or don't choose any articles to summarize.

Or just keep all the directories empty and just focus on one action at a time for now.

## The download article feature

Hit the download from cloud icon on a news item and this is what we see:

bart.controller.getArticleSummary: article {
  link: 'https://www.usatoday.com/story/news/nation/2022/05/14/buffalo-new-york-shooting-tops/9778322002/'
}
bart.service.getArticleSummary: articleUrl <https://www.usatoday.com/story/news/nation/2022/05/14/buffalo-new-york-shooting-tops/9778322002/>

No file is written.

Hit that again and see this:

bart.controller.getArticleSummary: article {
  link: 'https://www.nytimes.com/live/2022/05/14/nyregion/buffalo-shooting'
}
bart.service.getArticleSummary: articleUrl <https://www.nytimes.com/live/2022/05/14/nyregion/buffalo-shooting>
bart.service getArticleSummary service err No model was supplied, defaulted to sshleifer/distilbart-cnn-12-6 (<https://huggingface.co/sshleifer/distilbart-cnn-12-6>)
bart.service getArticleSummary service err No model was supplied, defaulted to sshleifer/distilbart-cnn-12-6 (<https://huggingface.co/sshleifer/distilbart-cnn-12-6>)

That message is an indication that a file is written:

service err No model was supplied, defaulted to sshleifer

